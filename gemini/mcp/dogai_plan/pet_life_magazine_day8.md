# Pet-Life Magazine: Day 8 - CMS 기능 정상화 및 배포 환경 안정화
- **문서 최종 업데이트:** 2025년 7월 21일
- **핵심 목표:** CMS의 데이터 동기화 문제를 React Query로 해결하고, 배포 환경(Netlify)에서 발생하는 기능 오류를 환경 변수 설정을 통해 해결하여 로컬과 동일한 수준의 안정성을 확보한다.

---

## 1. 문제 진단: 왜 데이터가 바로 보이지 않는가?

- **근본 원인:** 현재 CMS는 데이터를 한 번 가져온 후, DB 내용이 변경되어도 화면을 **자동으로 새로고침하는 기능이 부재**하다.
- **결론:** 이는 버그가 아니라, `useState`와 `useEffect`만으로는 서버 상태와 UI를 동기화하기 복잡하기 때문에 발생하는 자연스러운 한계다.

---

## 2. 해결 전략: React Query 도입

서버 상태 관리 라이브러리인 **React Query (Tanstack Query)**를 도입하여, 데이터 관리 방식을 전면적으로 개선한다.

---

## 3. 실행 계획 및 결과 (완료)

### Phase 1 ~ 4: CMS 기능 정상화 - ✅ 완료
- **React Query 도입:** `useState`와 `useEffect` 기반의 데이터 ��직을 `useQuery`와 `useMutation`으로 전면 리팩토링했다.
- **핵심 문제 해결:** '저장 후 반영 안 됨', '삭제 후 그대로 보임' 등 CMS의 핵심적인 데이터 비동기화 문제를 **완전히 해결했다.**
- **사용성 개선:**
    - 발행된 글은 '업데이트' 버튼이 표시되도록 수정했다.
    - 마크다운 에디터를 도입하여 서식 유지가 가능해졌고, 이미지 업로드 기능을 통합했다.
    - 'AI 서식 도우미' 기능을 추가하여, 챗GPT의 글을 버튼 하나로 완벽한 마크다운으로 변환할 수 있게 되었다.

---

## 4. Phase 5: 배포 환경 문제 해결 및 안정화 - ✅ 완료

### 4.1. 문제 발생: "로컬에서는 되는데, 배포 후에는 안 돼요"
- **현상:** 로컬 환경에서는 모든 기능이 정상 작동했으나, Netlify에 배포된 웹사이트에서는 '초안 생성' 기능이 404 오류를 내며 실패했다.
- **원인 분석:** '초안 생성' 기능은 내부적으로 Gemini AI를 호출하여 초안을 생성하도록 고도화되었다. 하지만 배포 환경(Netlify)에는 이 AI에 접근하기 위한 **`GEMINI_API_KEY` 환경 변수가 설정되어 있지 않았다.**
- **핵심 원리:** 로컬의 `.env.local` 파일은 보안상 `git push`로 업로드되지 않으므로, 배포 플랫폼에는 필요한 모든 환경 변수를 별도로 설정해주어야 한다.

### 4.2. 해결 과정
1.  **Netlify 환경 변수 설정:** Netlify 대시보드의 `Site settings > Build & deploy > Environment` 메뉴에서, 누락되었던 `GEMINI_API_KEY`를 직접 추가했다.
2.  **재배포:** 변경된 설정을 적용하기 위해 사이트를 재배포했다.
3.  **결과:** **문제가 완전히 해결되었다.** 배포된 웹사이트에서도 '초안 생성' 기능이 AI 초안을 만들며 정상적으로 작동하는 것을 확인했다.

---

## 5. Phase 6: E-E-A-T 자동 강화 시스템 구축 - ✅ 완료

- **문제 인식:** 애드센스 승인 및 사이트 신뢰도 향상을 위해, 모든 콘텐츠에 저자의 전문성(E-E-A-T)을 명확히 증명해야 할 필요성을 인지했다.
- **해결 전략:** 'AI 서식 도우미'(`format-article-with-ai` 함수)를 '지능형 편집 어시스턴트'로 업그레이드하여, 신뢰도 강화 작업을 자동화했다.
- **구현 내용:**
    1.  **개인 전문가 프로필 연동:** `puppyvill.com/jason`이라는 강력한 신뢰 자산을 `mungai.co.kr`와 연결하기로 결정했다.
    2.  **AI 프롬프트 업그레이드:** AI 함수가 글을 변환할 때, 저자 정보 라인에 **개인 전문가 프로필**(`[전문가 김주영](...)`)과 **팀/브랜드 소개**(`[Pet-Life Magazine](...)`) 링크가 모두 포함되도록 프롬프트를 수정하고 배포했다.
- **기대 효과:** 이제 모든 아티클은 별도의 수작업 없이도, 생성될 때부터 개인의 전문성과 팀의 신뢰성을 모두 증명하는 E-E-A-T의 핵심 요소를 자동으로 갖추게 되었다.
