# Pet-Life Magazine: Day 13 - 커뮤니티 기능 MVP 완성 및 데이터베이스 안정화
- **문서 최종 업데이트:** 2025년 7월 26일
- **핵심 목표:** 데이터베이스 동기화 문제를 해결하고, 완전한 CRUD(생성, 읽기, 수정, 삭제) 기능을 갖춘 커뮤니티 MVP(최소 기능 제품)를 성공적으로 구축한다.

---

## 1. 주요 개발 과정

### 1.1. 데이터베이스 기반 구축 및 안정화
- **문제 직면:** `supabase db push` 명령어가 로컬과 원격의 마이그레이션 기록 불일치로 인해 반복적으로 실패.
- **해결 과정:**
    1.  **진단:** `supabase migration list`로 로컬의 불완전한 마이그레이션 파일들과 원격 DB 기록 간의 충돌을 확인.
    2.  **초기화:** 로컬 `migrations` 폴더를 비우고, `supabase migration repair`로 원격 기록을 정리한 후, `supabase db pull`을 통해 원격 DB의 현재 상태를 기준으로 완벽하게 동기화된 새로운 로컬 마이그레이션 파일을 생성. **이 과정을 통해 DB 동기화 문제를 근본적으로 해결.**
    3.  **스키마 확장:** `user_profiles` 테이블에 `username`, `avatar_url` 컬럼을 추가하여 커뮤니티 작성자 정보를 저장할 기반�� 마련.
    4.  **`VIEW` 도입:** `posts_with_author`, `comments_with_author` 라는 DB `VIEW`를 생성. 프론트엔드에서 복잡한 Join 없이 작성자 정보가 포함된 데이터를 효율적으로 조회할 수 있도록 하여, **'관계(relationship)를 찾을 수 없음' 오류를 원천적으로 해결.**

### 1.2. 커뮤니티 기능 MVP 완성
- **코드 구조화:** `src/pages/community` 폴더를 생성하여 커뮤니티 관련 모든 파일(페이지, 훅, 컴포넌트)을 한곳에서 관리하도록 구조를 개선.
- **핵심 CRUD 구현:**
    - **읽기 (Read):** `CommunityPage`(목록)와 `PostDetailPage`(상세)를 구현. `usePosts`, `usePost` 훅을 통해 DB `VIEW`에서 데이터를 효율적으로 조회.
    - **생성 (Create):** `PostEditorPage`와 `useCreatePost` 훅을 구현하여 사용자가 새 글을 작성하고 DB에 저장하는 기능 완성.
    - **수정 (Update):** `PostEditorPage`를 재활용하여, `useUpdatePost` 훅과 연동된 글 수정 기능 구현.
    - **삭제 (Delete):** `useDeletePost` 훅과 확인 모달(Alert Dialog)을 연동하여 안전한 글 삭제 기능 구현.
- **소통 기능 강화:**
    - **댓글:** 상세 페이지에 댓글 목록과 함께, 로그인한 사용자가 새 댓글을 작성할 수 있는 기능 구현.
    - **좋아요:** `toggle_like` DB 함수와 `useToggleLike` 훅을 연동하여, 상세 페이지와 목록 페이지 양쪽에서 '좋아요'를 누를 수 있는 기능 구현.
- **사용자 경험(UX) 개선:**
    - **페이지네이션:** 게시글이 많아질 경우를 대비하여, 목록 페이지에 페이지 이동 기능 구현.
    - **친근한 문구:** `PostEditorPage`의 모든 문구를 귀엽고 친근한 톤으로 수정하여 플랫폼의 분위기를 통일.
    - **오류 수정:** `Link is not defined` 등 개발 과정에서 발생한 자잘한 오류들을 모두 수정.

---

## 2. 핵심 배운 점 (Lessons Learned)

- **"DB 동기화의 정석":** 로컬과 원격 DB의 스키마가 꼬였을 때, 가장 안전하고 확실한 해결책은 **로컬 마이그레이션을 비우고 `supabase db pull`을 통해 원격의 '진실'을 가져오는 것**이다. 이는 다른 기능에 영향을 주지 않으면서 개발 환경을 깨끗하게 재설정하는 전문적인 방법이다.
- **"프론트엔드 복잡성은 DB `VIEW`로 해결하라":** 여러 테이블을 Join해야 하는 복잡한 데이터 조회는 프론트엔드에서 처리하기보다, 데이터베이스에 `VIEW`를 생성하여 미리 처리해두는 것이 훨씬 효율적이고 안정적이다. 이는 코드의 가독성을 높이고 잠재적인 오류를 크게 줄여준다.
- **"기능은 역할�� 따라 모듈화하라":** 특정 기능(커뮤니티)과 관련된 파일들을 하나의 폴더에 모아 관리하는 것은, 프로젝트 규모가 커질수록 유지보수성을 극적으로 향상시키는 매우 중요한 습관이다.
- **"사용자 경험은 디테일에서 나온다":** '좋아요' 기능이나 '페이지네이션'처럼 당연해 보이는 기능들이 실제 사용자의 만족도와 서비스의 완성도를 결정한다. MVP를 빠르게 구축한 후, 이러한 디테일을 점진적으로 추가하는 개발 방식이 효과적이다.
